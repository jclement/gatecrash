services:
  server:
    image: ghcr.io/jclement/gatecrash:latest
    command: ["gatecrash", "server", "--config", "/etc/gatecrash/gatecrash.toml"]
    ports:
      - "80:80"
      - "443:443"
      - "${SSH_PORT:-2222}:${SSH_PORT:-2222}"
    volumes:
      - config:/etc/gatecrash
    restart: unless-stopped

  # Example: client sidecar for a web app
  # client:
  #   image: ghcr.io/jclement/gatecrash:latest
  #   command: ["gatecrash", "client"]
  #   environment:
  #     GATECRASH_SERVER: server:2222
  #     GATECRASH_TOKEN: "web-app:YOUR_SECRET"
  #     GATECRASH_TARGET: webapp:3000
  #   depends_on: [webapp]
  #   restart: unless-stopped
  #
  # webapp:
  #   image: your-webapp:latest
  #   expose: [3000]

volumes:
  config:
